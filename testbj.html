<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Blackjack</title>
    <style>
      .handCard {
        font-size: 120px;
      }
    </style>
  </head>
  <body>
    <h1>Blackjackto</h1>
    <div id="output-area"></div>
    <button type="text" id="new-game-button" onclick="startNewGame()">
      New Game!
    </button>
    <button
      type="text"
      id="hit-button"
      onclick="dealAnotherCard(player); ShowHands();"
    >
      Hit!
    </button>
    <button type="text" id="stay-button">Stay</button>
    <div id="winner-area"></div>

    <div style="font-size:5em" id="ornek"></div>
    <script>
      "use strict";
      const cards = [
        { card: "🂡", value: 1 },
        { card: "🂢", value: 2 },
        { card: "🂣", value: 3 },
        { card: "🂤", value: 4 },
        { card: "🂥", value: 5 },
        { card: "🂦", value: 6 },
        { card: "🂧", value: 7 },
        { card: "🂨", value: 8 },
        { card: "🂩", value: 9 },
        { card: "🂪", value: 10 },
        { card: "🂫", value: 10 },
        { card: "🂬", value: 10 },
        { card: "🂮", value: 10 },
        { card: "🂱", value: 1 },
        { card: "🂲", value: 2 },
        { card: "🂳", value: 3 },
        { card: "🂴", value: 4 },
        { card: "🂵", value: 5 },
        { card: "🂶", value: 6 },
        { card: "🂷", value: 7 },
        { card: "🂸", value: 8 },
        { card: "🂹", value: 9 },
        { card: "🂺", value: 10 },
        { card: "🂻", value: 10 },
        { card: "🂼", value: 10 },
        { card: "🂾", value: 10 },
        { card: "🃁", value: 1 },
        { card: "🃂", value: 2 },
        { card: "🃃", value: 3 },
        { card: "🃄", value: 4 },
        { card: "🃅", value: 5 },
        { card: "🃆", value: 6 },
        { card: "🃇", value: 7 },
        { card: "🃈", value: 8 },
        { card: "🃉", value: 9 },
        { card: "🃊", value: 10 },
        { card: "🃋", value: 10 },
        { card: "🃍", value: 10 },
        { card: "🃎", value: 10 },
        { card: "🃑", value: 1 },
        { card: "🃒", value: 2 },
        { card: "🃓", value: 3 },
        { card: "🃔", value: 4 },
        { card: "🃕", value: 5 },
        { card: "🃖", value: 6 },
        { card: "🃗", value: 7 },
        { card: "🃘", value: 8 },
        { card: "🃙", value: 9 },
        { card: "🃚", value: 10 },
        { card: "🃛", value: 10 },
        { card: "🃝", value: 10 },
        { card: "🃞", value: 10 }
      ];
      let deck = [];
      // 5.1
      const player = [];
      const dealer = [];
      // 5.2
      let outputArea = document.getElementById("output-area");
      let winnerArea = document.getElementById("winner-area");

      // 8.1
      let btnStartNewGame = document.getElementById("new-game-button");
      let btnHit = document.getElementById("hit-button");
      let btnStay = document.getElementById("stay-button");

      btnStay.addEventListener("click", function() {
        hideGameButtons();

        while (
          dealerScore < playerScore &&
          playerScore <= 21 &&
          dealerScore <= 21
        ) {
          dealer.push(drawCard());
          calculateHands();
        }
        ShowHands(true);
      });
      // 7.7-1
      let playerScore = 0;
      // 7.8-2
      let dealerScore = 0;
      hideGameButtons();
      let round = 0;
      /**####### FONKSİYONLAR ######## **/
      /**
       * Desteyi karıştıran fonksıyon
       * @param null
       * return null
       */
      const shuffleDeck = () => {
        let tempArray, tempDeck;
        tempArray = [];
        tempDeck = [...cards]; // tüm kartlar burda

        while (tempDeck.length > 0) {
          let cardLength = tempDeck.length - 1;
          let pos = Math.floor(Math.random() * cardLength);
          let card = tempDeck[pos];
          tempArray.push(card);
          tempDeck.splice(pos, 1); // splice ( bu indexten itibaren , bu kadar adet sil)
        }
        deck = tempArray;
      };

      const determineWinner = stayed => {
        const dealerWins = "Dealer Wins!",
          playerWins = "You win!,",
          draw = "Draw";

        // kimin sayısı 21'i geçtiyse kazananı ilan et
        if (isBust(playerScore)) {
          return dealerWins;
        } else if (isBust(dealerScore)) {
          return playerWins;
        } else if (dealer.length == 5 && dealerScore <= 21) {
          return dealerWins;
        }

        if (!stayed) return "";

        // Kimde blackjack varsa değerlendir
        let dealerBJ = hasBlackJack(dealer, dealerScore);
        let playerBJ = hasBlackJack(player, playerScore);

        if (playerBJ && dealerBJ) {
          return draw;
        }

        if (playerBJ) {
          return playerWins;
        }

        if (dealerBJ) {
          return dealerWins;
        }

        // blackjack yok puanlara göre değerlendir
        if (dealerScore == playerScore) {
          return draw;
        } else if (playerScore > dealerScore) {
          return playerWins;
        } else if (playerScore < dealerScore) {
          return dealerWins;
        }

        return "";
      };

      const showGameButtons = () => {
        btnStartNewGame.style.display = "none";
        btnHit.style.display = "inline";
        btnStay.style.display = "inline";
      };

      function hideGameButtons() {
        btnStartNewGame.style.display = "inline";
        btnHit.style.display = "none";
        btnStay.style.display = "none";
      }

      const isBust = score => {
        return score > 21;
      };

      const hasBlackJack = (hand, score) => {
        return hand.length == 2 && calculateHand(hand) == 21;
      };
      /**
       *
       *Ekranda gösterilen kartlar için template oluşturan fonksiyon
       */
      const getShowHandsTemplate = (player, dealer) => {
        return `
              <h2> Player</h2>
              <span class="handCard">${player[0]}</span>
              <span class="handCard">${player[1]}</span>
              <h2> Dealer </h2>
              <span class="handCard">${dealer[0]}</span>
              <span class="handCard">${dealer[1]}</span>
            `;
      };

      const drawCard = () => {
        let draw = deck.shift();
        return draw;
      };

      // 6.1
      const ShowHand = (hand, score) => {
        // 6.2
        let cards = "";
        // 6.4
        hand.forEach(
          // 6.5-1
          // c => (cards += `<span class="handCard">${c} ${score}</span>`)
          c => (cards += `<span class="handCard">${c.card}</span>`)
        );

        return cards + score;
      };

      //7.1
      const calculateHand = cards => {
        // 7.2
        let score = 0;

        // 7.4
        cards.forEach(c => (score += c.value));

        // 7.3-1
        let ace = cards.find(c => c.value === 1);

        // 7.3-2
        if (ace) {
          // blackjack var
          // 7.5
          if (10 < score && score < 21) {
            score += 10;
          }
        } else {
          // blackjack degil
        }

        // 7.6
        return score;
      };

      // 6.8
      const clearTable = () => {
        // 6.9
        outputArea.innerHTML = "";
      };

      // 5.8
      const dealInitialCards = () => {
        // 5.9
        [1, 2].forEach(() => player.push(drawCard()));
        // 5.10
        [1, 2].forEach(() => dealer.push(drawCard()));

        ShowHands();
      };

      // 8.3
      const startNewGame = () => {
        showGameButtons();
        // 8.5
        deck.length = 0;
        player.length = 0;
        dealer.length = 0;

        // 8.5
        shuffleDeck();
        dealInitialCards();
      };

      // 9.1
      const dealAnotherCard = hand => {
        hand.push(drawCard());
      };

      const calculateHands = () => {
        playerScore = calculateHand(player);
        dealerScore = calculateHand(dealer);
      };

      const ShowHands = (stayed = false) => {
        clearTable();
        calculateHands();

        outputArea.innerHTML += ShowHand(player, playerScore);
        outputArea.innerHTML += "<br/>";
        outputArea.innerHTML += ShowHand(dealer, dealerScore);

        let winner = determineWinner(stayed);
        winnerArea.innerHTML = winner;
        if (winner) {
          hideGameButtons();
        }
      };
    </script>
  </body>
</html>
<!--
09 — Yeni Kart Cekme
Şimdi, Hit'e(yeni kart ver) bir click event bağlama zamanı!Hit düğmesine basın ve başka bir kart çekmek için kod ekleyin. 
DealInitialCard, skorları hesaplayan ve eli ShowHands adlı ayrı bir fonksiyona gösteren kodu kırmak için yeniden düzenleme gerektiriyor. 
Kod çoğaltmasını önlemek için bunu yapın.
1. ShowHands adında parametre almayan yeni bir fonksiyon ekleyin.
2. Puanı ve ShowHand fonksiyonuna yapılan çağrıları dealInitialCards fonksiyonundan hesaplayan kodu kesin (işlevdeki son dört kod satırı olmalıdır).
3. dealInitialCards fonksiyonunun sonuna ShowHand fonksiyonuna bir çağrı ekleyin.
4. dealInitialCards fonksiyonundan clearTable fonksiyon çağrısını kesin ve ShowHands fonksiyonundaki ilk 
ShowHand fonksiyon çağrısının üstüne ekleyin.
5. Kartları ve skor verilerini outputArea'ya, aynı verileri 
ShowHand fonksiyonundan döndüren bir return ifadesiyle değiştiren kodu değiştirin.
6. ShowHand fonksiyonuna yapılan çağrıların sonucunu outputArea değişkenine ekleyin.
7. Player veya delaer elini alan hand adlı bir parametreye sahip dealAnotherCard adlı yeni bir fonksiyon ekleyin.
8. drawCard fonksiyonunu çağırın ve döndürülen kartı hand parametresindeki diziye ekleyin.
9. Hit düğmesi için bir click event listener ekleyin.
10. clickAnotherCard fonksiyonunu ve ardından click eventinden ShowHands fonksiyonunu çağırın.
11. Dosyayı kaydedin ve Start Game düğmesine basın.
12. Oyuncuya başka bir kart dağıtmak için Hit! düğmesine basın. Destedeki kartlar bitene kadar kart dağıtabileceğinizi unutmayın. Daha sonra player ve delaerelleri arasındaki karşılaştırmayı uyguladığınızda bunu düzeltirsiniz.

  
-->
